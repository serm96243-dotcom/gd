{
  "title": "HOOKS-API. Формирование HTTP-запросов",
  "text": "Была ли статья полезной?\nДа\nНет\nСпасибо за вашу оценку!\nОставляя более подробный отзыв, вы помогаете нам улучшать документацию\nКомментарий к оценке\nКонтактная информация (необязательно)\nВложения\nДобавить файл\nОтменить\nОтправить\nHOOKS-API. Формирование HTTP-запросов\nAPI платформы GreenData – это интерфейс программирования, который позволяет разработчикам взаимодействовать с платформой, предоставляя набор готовых функций, методов и структур данных.\nС помощью API GreenData пользователи могут выполнять HTTP-запросы для выполнения различных операций, среди которых важно отметить возможность:\nполучения доступа к объектам системы, что позволяет взаимодействовать с различными типами объектов, которые хранятся в системе;\nработы с ETL-процессом\n: интеграция и управление процессами извлечения, преобразования и загрузки данных, что упрощает управление данными и их обработку;\nформирования, получения и установки обновления\n;\nполучения данных из источника\n.\nПредполагается, что работа с API организована на внешнем сервере (\nне\nна сервере платформы), который отправляет к серверу платформы запросы определенного типа. Для удобства в этой статье будет рассмотрена отправка запросов при помощи приложения Postman. В качестве альтернативы можно использовать иные приложения.\nОбщие принципы\nHTTP-запрос формируется следующим образом:\n{url}/hooks/{plugin}/{path_params}?{query_params}\ntext\nCopied!\nгде:\n{url} – адрес приложения, к которому осуществляется запрос;\nhooks – наименование API, значение постоянно для любого типа запроса;\n{plugin} – идентификатор плагина, по которому осуществляется запрос (перечень доступных плагинов представлен\nдалее\n);\n{path_params} – параметры пути, которые могут использоваться, например, для аутентификации пользователя;\nС доступными способами аутентификации можно ознакомиться\nдалее\n.\nПри перечислении нескольких параметров пути их необходимо отделять слэшем \"/\".\n{query_params} – параметры запроса, которые могут использоваться для передачи данных в тело запроса, указания деталей поиска данных и т.д.\nПараметры запроса указываются после вопросительного знака \"?\".\nПри перечислении нескольких параметров запроса их необходимо отделять амперсандом \"&\".\nВ зависимости от выполняемой операции API GreenData принимает POST, GET, PUT и DELETE-запросы.\nТекст самого запроса должен соответствовать формату XML или JSON.\nФорматы получаемых и передаваемых данных могут быть заданы через HTTP-заголовки:\nТип данных, отправляемых Системе, обозначается в HTTP-заголовке \"\nContent-Type\n\".\nЕсли заголовок \"\nContent-Type\n\" не задан, Система будет рассматривать поступивший текст запроса в формате, указанном в\n\"Источнике. Внешний сервис\"\nв поле \"Формат ответа\".\nТип данных, получаемых из Системы, задается в HTTP-заголовке \"\nAccept\n\".\nЕсли заголовок \"\nAccept\n\" не задан, по умолчанию используется\nJSON\n.\nОпределение формата типа данных задается в HTTP-заголовке значением:\napplication/xml – для XML;\napplication/json – для JSON.\nНапример, при выполнении GET-запроса для запуска ETL-процесса в случае отсутствия настроенного\nответного сообщения от ETL\nприложение сформирует следующий ответ:\nВ данном ответе используются следующие тэги объекта:\n<code> – результат выполнения запроса. Возможные значения:\nОК – запрос выполнен успешно;\nERROR – запрос выполнен с ошибкой.\n<message> – сообщение о выполнении запроса.\nВ случае успешного выполнения запроса система отобразит \"ОК\", в случае возникновения ошибки – текст ошибки.\nУспешность обработки запроса можно определить по HTTP-статусу запроса, с наиболее распространенными можно ознакомиться\nдалее\n.\nС\nпримерами формирования запросов\nможно ознакомиться в статьях:\nРабота с ETL через API\n;\nРабота с обновлениями через API\n;\nРабота с источником данных через API\n;\nСкачивание файла через API\n.\nДоступные плагины\nПлагины, реализованные в Системе, представлены в таблице ниже. Для создания запроса формируемый URL должен содержать идентификатор плагина.\nНазначение\nИдентификатор плагина\nКонтроль доступа\nЗапуск ETL-процесса\netl\n\"Выполнение\" соответствующего объекта ETL\nПолучение данных из источника\ndatasource\n\"Выполнение\" соответствующего экземпляра источника\nРабота с интеграционными объектными чатами\nobjectChatsWebHookPlugin\n\"Выполнение\" разрешения\n\"Доступ к webhook плагину объектных чатов\"\nЗагрузка объектов из Excel файлов по\nшаблону\nexcelObjectLoader\n\"Чтение\" соответствующего экземпляра шаблона\n\"Создание экземпляров типа\" и \"Редактирование экземпляров типа\" для типа объекта, предназначенного для хранения данных\nРеагирование на события от\nMango Office\nmango\nПроверка\nподписи\nзапроса и\nправ доступа\nк аккаунту АТС\nСкачивание файла\ndownloadFile\n\"Чтение\" соответствующего файла\nДоступ на скачивание файла\nИнтеграция между приложениями платформы\nintegration\n\"Чтение\", \"Создание\" и \"Редактирование\" интегрируемых объектов\nРабота с обновлениями, созданными через CI/CD\ncicd\n\"Чтение экземпляров типа\" для типа объекта \"Обновление, созданное через CI/CD\" [SYS_CI_CD_PUBLISHED]\n\"Чтение\" соответствующего экземпляра обновления\nОбработка событий\nвнешних чатов\nexternalChat\n\"Выполнение\" разрешения\n\"Доступ к webhook плагину внешних чатов\"\nЗапись идентификатора плагина чувствительна к регистру.\nAPI без аутентификации\nПеречень API, которые доступны без аутентификации, включает:\n/error\n– ссылка на страницу с ошибкой;\n/api/asvr/**\n– кастомная аутентификация через keycloak;\n/health\n– встроенный механизм Spring для мониторинга состояния приложения;\n/prometheus\n– ссылка на prometheus;\n/dist/**\n– js файлы (фронт);\n/robot.txt\n– текстовый файл, который содержит параметры индексирования сайта для поисковых систем;\n/loader/**\n– загрузчик изображений для окна аутентификации;\n/hooks/**\n– аутентификация по токену для ETL;\n/api/bot/**\n– доступ к чату, через токен;\n/view/login/background\n– получение изображения окна аутентификации;\n/images/**\n– устаревший путь к файлам логотипа и индикатора загрузки;\n/auth/js/**\n– страница аутентификации;\n/registration/js/**\n– страница регистрации;\n/recover/js/**\n– страница восстановления;\n/api/saas/warmup\n– подготовка saas, подгрузка в кэш базовых типов;\n/join\n– ссылка-приглашение в чат;\n/api/messenger/chat/joinLinkInfo\n– ссылка на MVP для внешних пользователей;\n/calls\n– окно создания встречи/присоединение к созданной\nвстрече GreenData Meet\n;\n/api/mobile/calls/webhook/**\n– окно для создания\nвстречи\nбез авторизации (звонки);\n/api/versions\n– получение информации о версии приложения;\n/api/sys/app-settings/mobile\n– получение настроек мобильного приложения.\nАутентификация посредством HTTP-запроса\nДля обеспечения безопасности и защиты данных доступ к API предоставляется только аутентифицированным пользователям.\nДля аутентификации при осуществлении HTTP-запросов можно использовать следующие методы:\nУказание учетных данных пользователя (логин и пароль) в настройках используемого программного обеспечения для формирования запросов.\nДобавление\nпользовательского токена\n:\nв строку URL\nпосле наименования плагина\n:\nчерез параметр GET-запроса \"token\":\nв качестве заголовка \"X-LowCode-Private-Token\" в настройках запроса:\nИспользование\nклиентского сертификата (mTLS)\n.\nОтвет запроса формируется на основании наличия прав и разрешений пользователя, под которым произведена аутентификация.\nНапример, для следующих POST-запросов проверяется наличие прав доступа:\napi\nНазначение\nПраво на действие \"Выполнение\" для\nразрешений\n/api/domainUsers\nСоздание доменного пользователя\nАдминистрирование пользователей\nУправление доменными пользователями\n/api/domainUsers/search\nПоиск доменного пользователя по произвольному фильтру\nУправление доменными пользователями\n/api/domainUsers/{ident}\nПоиск доменного пользователя по имени учетной записи\nУправление доменными пользователями\nПри отсутствии прав на необходимые разрешения и просмотр пользователей сервер вернет код ответа 403.\nВозможные коды ответов сервера\nВозможные коды ответов сервера:\n200 – код при успешном выполнении запроса;\n201 – в результате успешного выполнения запроса был создан новый объект;\n302 – выполнено перенаправление (redirect);\n400 – некорректный HTTP-запрос, сервер не смог его обработать;\n401 – неудачная авторизация (необходимо проверить корректность логина и пароля или пользовательского токена);\n403 – доступ запрещён;\n404 – запрашиваемый объект не найден (возможно, его уже удалили или указан неверный идентификатор объекта);\n422 – ошибка валидации;\n500 – внутренняя ошибка сервера (возможно, некорректно сформирован запрос или сервер не отвечает).\nОтключение HOOKS-API\nОтключение HOOKS-API осуществляется в\nконфигурационном файле приложения\napp.yml\nследующим образом:\ngreendata-core:\nhttp:\nblockedPaths:\n-\npath:\n/hooks/etl/**\n# Запуск ETL\n-\npath:\n/hooks/datasource/**\n# Запуск DataSource\n-\npath:\n/hooks/objectChatsWebHookPlugin/**\n# Обмен сообщениями в объектном чате\n-\npath:\n/hooks/excelObjectLoader/**\n# Запуск загрузчика объектов из Excel\n-\npath:\n/hooks/mango/**\n# События Mango Office\n-\npath:\n/hooks/downloadFile/**\n# Загрузка файла\n-\npath:\n/hooks/integration/**\n# Интеграция\n-\npath:\n/hooks/cicd/**\n# CI/CD\n-\npath:\n/hooks/externalChat/**\n# Интеграция с внешними чатами\nyaml\nCopied!",
  "source": "https://docs.greendata.ru/platform/ru/hooks-api.html"
}