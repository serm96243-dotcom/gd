{
  "title": "Настройка пула подключений к базе данных",
  "text": "Была ли статья полезной?\nДа\nНет\nСпасибо за вашу оценку!\nОставляя более подробный отзыв, вы помогаете нам улучшать документацию\nКомментарий к оценке\nКонтактная информация (необязательно)\nВложения\nДобавить файл\nОтменить\nОтправить\nНастройка пула подключений к базе данных\nДля настройки конфигурации\nHikari Connection Pool\nв Системе предусмотрен класс Pool.\npool:\nconnectionTimeout:\n30_000\nidleTimeout:\n200_000\nmaximumPoolSize:\n100\nleakDetectionThreshold:\n500_000\nmaxLifetime:\n600_000\nyaml\nCopied!\nОн содержит все необходимые параметры для настройки подключения\nтакие как:\nПараметр\nНазначение\nЗначение по умолчанию\njdbcDriver\nПозволяет динамически указывать jar драйвера.\nconnectionInitSql\nЗадаёт строку SQL, которая будет выполняться для всех новых подключений при их создании.\nconnectionTimeout\nУстанавливает время ожидания (в миллисекундах) для установления нового подключения к базе данных.\n30_000 мс.\nidleTimeout\nУстанавливает время (в миллисекундах), в течение которого неиспользуемое подключение к базе данных остается открытым.\n200_000 мс.\nmaximumPoolSize\nОпределяет максимальный размер, которого может достигать пул, включая как незанятые, так и используемые подключения.\n100 подключений.\nleakDetectionThreshold\nОпределяет количество времени, в течение которого соединение может находиться вне пула,\nпрежде чем будет зарегистрировано сообщение, указывающее на возможную утечку соединения.\n500_000 мс.\nmaxLifetime\nОпределяет максимальное время жизни соединения (в миллисекундах) в пуле.\n600_000 мс.\nПри неправильном написании запроса или несуществующих конфигураций сервер выдаст ошибку, её описание в логах:\n[Ваш запрос] - Error in writing the user configuration connectionInitSql\nДополнительные настройки подключения\nВ файле\napplication.yml\nможно задать дополнительные параметры сессии PostgreSQL следующим образом:\ngreendata-core:\npostgres:\nsession-parameters:\nidle_in_transaction_session_timeout:\n5min\nyaml\nCopied!\nПараметры из\nsession-parameters\nавтоматически включаются в итоговый\nconnectionInitSql\n.\nНапример, при вышеуказанной конфигурации будет добавлено:\nSET\nidle_in_transaction_session_timeout =\n'5min'\n;\nsql\nCopied!\nБазовое значение по умолчанию:\nidle_in_transaction_session_timeout = 30min\n.\nЕсли параметр\nconnectionInitSql\nзадан вручную, и в нём также указано\nSET idle_in_transaction_session_timeout\n, то последнее встреченное значение будет иметь приоритет. Таким образом, при конфликте настроек,\nпоследний SET перезапишет предыдущий\n.\nПример задания значения новой настройки\ngreendata-core:\npostgres:\nsession-parameters:\nlock_timeout:\n10s\nidle_in_transaction_session_timeout:\n2min\nyaml\nCopied!\nВ результате в SQL будут добавлены:\nSET\nlock_timeout =\n'10s'\n;\nSET\nidle_in_transaction_session_timeout =\n'2min'\n;\nsql\nCopied!",
  "source": "https://docs.greendata.ru/platform/ru/setting_up_database_connection_pool.html"
}